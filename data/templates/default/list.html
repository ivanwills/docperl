[% UNLESS history_size %][% history_size = 10 %][% END -%]
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-AU" xml:lang="en-AU">
	<head>
		<title>DocPerl Index</title>
		<meta http-equiv="Content-Type"		content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Language"	content="en-au" />
		<meta name="author"		 content="Ivan Wills" />
		<meta name="copyright"	 content="Copyright (c) 2006 Ivan Wills, All Rights Reserved" />
		<meta name="description" content="" />
		<meta name="keywords"	 content="" />
		<style type="text/css">
		<!--/* <![CDATA[ */
			@import url("?page=css.css");
			body {
				font-size:			8pt;
				padding:			0px;
				margin:				0px;
			}
			h1, h2, h3 {
				margin-top:			0px;
				padding:			5px 2px 4px 2px;
				font-family:		sans-serif;
			}
			h1 {
				font-size:			1.4em;
				text-align:			center;
				-moz-border-radius:	0px;
			}
			h2 {
				font-size:			1.2em;
				-moz-border-radius:	0px;
				
			}
			table {
				font-size:			0.9em;
				
			}
			ul {
				font-size:			1em;
				list-style-type:	none;
				padding-left:		0px;
				margin-left:		0px;
			}
			li {
				clear:				left;
			}
			ul li {
				padding-left:		0.3em;
			}
			ul ul {
				padding-left:		0.3em;
				margin-left:		0.3em;
			}
			li > ul {
				display:			none;
			}
			.plus {
				padding-left:		2px;
				padding-right:		2px;
				border-style:		solid;
				border-width:		1px;
			}
			.mod_expand {
				width:				1em;
				margin-right:		0.8em;
				text-align:			center;
				vertical-align:		middle;
				display:			block;
				float:				left;
				border-style:		solid;
				border-width:		1px;
				clear:				left;
				-moz-border-radius:	4px;
				border-radius:		4px;
				text-decoration:	none;
			}
			.mod_expand {
				-moz-border-radius:	3px;
				border-radius:		3px;
			}
			.info {
				width:				10px;
				-moz-border-radius:	10px;
				border-width:		1px;
				border-color:		red;
				border-style:		solid;
				float:				right;
				text-align:			center;
			}
			.info span {
				display:			none;
				float:				right;
				border:				1px solid black;
				background-color:	white;
				padding:			3px;
				position:			relative;
				left:				1px;
				top:				1px;
			}
			.info:hover span {
				display:			block;
			}
		/* ]]> */-->
		</style>
		<script type="text/javascript">
		<!--
			[% js.pod %]
			[% js.inc %]
			[% js.local %]
			[% perl %]
			[% inc %]
			[% local %]
			var links = new Array();
			var level;
			var group = 0;
			var counter = { perl:0, local:0, inc:0 };
			
			function setup_modules() {
				// set up each of perl, inc and local
				if ( group == 0 ) {
					level = 0;
					var total_perl = create_tree( perl,	document.getElementById('perl'),	'perl' );
					group++;
					setTimeout( setup_modules, 10 );
				}
				else if ( group == 1 ) {
					level = 0;
					group++;
					create_tree( local,	document.getElementById('local'),	'local' );
					setTimeout( setup_modules, 30 );
				}
				else if ( group == 2 ) {
					level = 0;
					group++;
					create_tree( inc,	document.getElementById('inc'),	'inc' );
					setTimeout( setup_modules, 50 );
				}
				else if ( group == 3 ) {
					group++;
					var name = 'DocPerl_recent';
					if ( exists_cookie( name ) ) {
						var list	= get_cookie( name );
						var modules	= list.split(':');
						
						for ( var module in modules ) {
							display_recent( modules[module] );
						}
					}
					setTimeout( setup_modules, 70 );
				}
				else if ( group == 4 ) {
					level = 0;
					group++;
					setTimeout( setup_modules, 90 );
				}
			}
			
			function add_count( counter, amount ) {
				var counter_span = document.getElementById( counter + '_count' );
				var counter_value = counter_span.firstChild.nodeValue;
				counter_value -= -amount;
				counter_span.removeChild( counter_span.firstChild );
				counter_span.appendChild( document.createTextNode( counter_value ) );
			}
			
			function reset_count( counter ) {
				var counter_span = document.getElementById( counter + '_count' );
				
				counter_span.removeChild( counter_span.firstChild );
				counter_span.appendChild( document.createTextNode( '0' ) );
			}
			
			function create_tree ( files, container, path, counter ) {
				// need to stick each module into a container
				var ul		 = document.createElement('ul');
				var count	 = 0;
				ul.className = 'mod_list';
				ul.id		 = 'ul__'+path;
				level++;
				if ( !counter )
					counter = path;
				
				for ( var module in files ) {
					if ( module != '*' ) {
						var li	= document.createElement('li');
						li.id	= 'li__' + path + '__' + module;
						var label;
						var data	= files[module];
						var num		= 0;
						for ( var sub in data ) {
							num++;
						}
						
						// the javascript contains only one element if there are no sub directories
						li.appendChild( create_plus( num >= 2 ? path + '__' + module : null ) );
						
						data = files[module]['*'];
						if ( data && data.length ) {
							label = create_module( path + '__' + module, module );
							count++;
						}
						else {
							label = document.createTextNode( module );
						}
						li.appendChild( label );
						
						var time = 50 + Math.floor( Math.random() * 50 );
						// recurse to get sub elements here
						setTimeout( create_tree, time, files[module], li, path + '__' + module, counter );
						
						ul.appendChild( li );
					}
				}
				
				container.appendChild( ul );
				add_count( counter, count );
				return count;
			}
			
			function create_module(path, module) {
				var label	= document.createElement('a');
				label.href	= '?page=module&module=' + path;
				//label.id	= 'a__' + path + '__' + module;
				label.setAttribute( 'onclick', 'javascript: click_module("' + path + '");' );
				label.setAttribute( 'target', '[% IF !sidebar %]main[% ELSE %]_content[% END %]' );
				label.appendChild( document.createTextNode( module ) );
				
				return label;
			}
			
			function create_plus(path) {
				var plus;
				// the javascript contains only one element if there are no sub directories
				if ( path ) {
					plus				= document.createElement('a');
					plus.id				= 'plus__' + path;
					plus.href			= 'javascript: list_toggle("' + path + '")';
					plus.className		= 'mod_expand';
					plus.style.cssText	= 'text-decoration: none';
					plus.appendChild( document.createTextNode( '+' ) );
				}
				else {
					plus				= document.createElement('div');
					plus.className		= 'mod_expand';
					plus.style.cssText	= 'border-width: 0px;';
					plus.appendChild( document.createTextNode( '.' ) );
				}
				
				return plus;
			}
			
			function click_module( path ) {
				var name = 'DocPerl_recent';
				if ( exists_cookie( name ) ) {
					var list	= get_cookie( name );
					var modules	= list.split(':');
					for ( var module in modules ) {
						if ( modules[module] == path )
							return;
					}
					list += ':' + path;
					modules.push(path);
					if ( modules.length >= [% history_size %] ) {
						var recent = document.getElementById('ul_recent');
						recent.removeChild( recent.firstChild );
						add_count( 'recent', -1 );
						modules.splice( 0,  modules.length - [% history_size %] );
					}
					set_cookie( name, modules.join(':') );
				}
				else {
					set_cookie( name, path );
				}
				display_recent(path);
			}
			
			function display_recent(path) {
				var path_parts	= path.split('__');
				var recent_doc	= document.getElementById('recent_doc');
				var recent_ul	= document.getElementById('ul_recent');
				var name		= '';
				recent_doc.style.cssText = '';
				
				for ( var i = 2; i < path_parts.length; i++ ) {
					if ( i != 2 )
						name += '::';
					name += path_parts[i];
				}
				
				var li	= document.createElement('li');
				li.appendChild( create_plus() );
				li.appendChild( create_module( path, name ) );
				
				recent_ul.appendChild( li );
				add_count( 'recent', 1 );
			}
			
			function search(force) {
				var string		= document.getElementById('search').value;
				var results_doc	= document.getElementById('results_doc');
				
				if ( !force && string.length < 4 )
					return;
				if ( !string ) {
					results_doc.style.cssText = 'display:none';
					return;
				}
				
				var terms		= string.split(/\s+/);
				var results		= document.getElementById('results');
				var ul			= document.createElement('ul');
				results_doc.style.cssText = '';
				
				while (results.firstChild)
					results.removeChild(results.firstChild);
				
				ul.id = 'ul__results';
				results.appendChild(ul);
				reset_count('results');
				
				for ( var i in terms ) {
					var term = terms[i];
					
					var list = show_found( new Array(perl.POD), term, 'perl__', 'POD' );
					if ( list )
						ul.appendChild( list );
					list = show_found( local, term, 'local__', 'Local' );
					if ( list )
						ul.appendChild( list );
					list = show_found( inc, term, 'inc__', 'Installed' );
					if ( list )
						ul.appendChild( list );
				}
			}
			
			function show_found( list, term, base, name ) {
				var count	= 0;
				var li		= document.createElement('li');
				var ul_sub	= document.createElement('ul');
				var path	= 'results__' + base;
				li.id		= 'li__' + path;
				ul_sub.id	= 'ul__' + path;
				li.appendChild( create_plus(path) );
				li.appendChild( document.createTextNode(name) );
				
				for ( var i in list ) {
					var item	= list[i];
					var found	= find_in( item, term );
					
					if ( found.length ) {
						count += found.length;
						
						for ( var item in found ) {
							var li_sub	= document.createElement('li');
							var name	= found[item];
							name = name.replace( /::/g, '__' );
							
							li_sub.appendChild( create_plus() );
							li_sub.appendChild( create_module( path + '__' + name, found[item] ) );
							ul_sub.appendChild(li_sub);
						}
					}
				}
				
				if ( !count )
					return null;
				
				add_count( 'results', count );
				li.appendChild(ul_sub);
				
				return li;
			}
			
			function find_in( object, term, name ) {
				var next	= name ? name + '::' : '';
				var found	= new Array();
				var regex	= new RegExp( term, 'i' );
				
				for ( var item in object ) {
					var module = next + item;
					
					// Check if the node is actually a module and if it matches the re
					if ( object[item]['*'] && object[item]['*'].length && module.match( regex ) ) {
						found.push( module );
					}
					
					// itterate to sub modules
					if ( item != '*' ) {
						var matches = find_in( object[item], term, module );
						for ( var i in matches )
							found.push( matches[i] );
					}
				}
				return found;
			}
			
			function list_toggle( id ) {
				var ul		= document.getElementById( 'ul__' + id );
				var link	= document.getElementById( 'plus__' + id );
				// check the status of the list
				if ( ul.style && ul.style.display ) {
					// list is open so close
					ul.style.display = '';
					link.removeChild( link.firstChild );
					link.appendChild( document.createTextNode('+') );
				}
				else {
					// list is closed so open
					ul.style.display = 'block';
					link.removeChild( link.firstChild );
					link.appendChild( document.createTextNode('-') );
				}
			}
			
			function section_toggle( section ) {
				var div		= document.getElementById( section );
				var head	= document.getElementById( section + '_head' );
				var link	= document.getElementById( 'plus__' + section );
				// check the status of the list
				if ( div.style && div.style.display ) {
					// list is closed so open
					div.style.display = '';
					head.style.paddingBottom = '';
					head.style.marginBottom = '';
					link.removeChild( link.firstChild );
					link.appendChild( document.createTextNode('-') );
				}
				else {
					// list is open so close
					div.style.display = 'none';
					head.style.paddingBottom = '1px';
					head.style.marginBottom = '1px';
					link.removeChild( link.firstChild );
					link.appendChild( document.createTextNode('+') );
				}
			}
			
			function get_cookie(name) {
				var result			= null;
				var my_cookie		= " " + document.cookie + "; ";
				var search_name		= " " + name + "=";
				var start_of_cookie	= my_cookie.indexOf(search_name);
				var end_of_cookie;
				
				if (start_of_cookie != -1) {
					start_of_cookie += search_name.length;
					// skip past cookie name
					end_of_cookie = my_cookie.indexOf(";",start_of_cookie);
					result = unescape(my_cookie.substring(start_of_cookie, end_of_cookie));
				}
				
				return result
			}

			function set_cookie(name, value, expires, path, domain, secure) {
				var expString	 = expires	== null	? "" : ("; expires=" + expires.toGMTString());
				var pathString	 = path		== null	? "" : ("; path=" + path);
				var domainString = domain	== null	? "" : ("; domain=" + domain);
				var secureString = secure	== true	? "; secure" : "";
				var new_cookie	 = name + "=" + escape(value) + expString + pathString + domainString + secureString;
				document.cookie	 = new_cookie;
			}

			function clear_cookie(name, path, domain, secure) {
				var ThreeDays	= 3 * 24 * 60 * 60 * 1000;
				var expDate		= new Date();
				expDate.setTime(expDate.getTime() - ThreeDays);
				set_cookie(name, "ImOutOfHere", expDate, path, domain, secure)
			}

			function exists_cookie(cookie) {
				return (get_cookie(cookie) == null) ? false : true;
			}
			
			function get_cookie_count(name) {
				var result			= 0;
				var my_cookie		= " " + document.cookie + ";";
				var search_name		= " " + name + "=";
				var name_length		= search_name.length;
				var start_of_cookie	= myCookie.indexOf(search_name);
				
				while (start_of_cookie != -1) {
					result += 1;
					start_of_cookie = my_cookie.indexOf(search_name, start_of_cookie + name_length);
				}
				return result;
			}
			
			function get_cookie_number(name, cookie_num) {
				var result = null;
				if (cookie_num >= 1) {
					var cntr			= 0;
					var my_cookie		= " " + document.cookie + ";";
					var search_name		= " " + name + "=";
					var name_length		= search_name.length;
					var start_of_cookie	= my_cookie.indexOf(search_name);
					
					for (cntr = 1; cntr < cookie_number; cntr++) {
						start_of_cookie = my_cookie.indexOf(search_name, start_of_cookie + name_length);
					}
					
					if (start_of_cookie != 1) {
						start_of_cookie	 += name_length; // skip past cookie name
						var end_of_cookie = my_cookie.indexOf(";", start_of_cookie);
						result = unescape(my_cookie.substring(start_of_cookie, end_of_cookie));
					}
				}
				return result;
			}
		//-->
		</script>
	</head>
	<body onload="setup_modules();">
	
		<h1>Perl Documentation</h1>
		<!--h2>Search</h2-->
		<center>
			<!--form action="" onsubmit="search(); return false;"-->
			<table>
				<tr>
					<th>Search&nbsp;:&nbsp;</th>
					<td><input type="text" name="search" id="search" size="15" onkeyup="search(false);"/></td>
				</tr>
				<tr>
					<td colspan="2" style="text-align: center"><input type="button" value="Find Modules" onclick="search(true);"/></td>
				</tr>
			</table>
			<!--/form-->
		</center>
		<div id="results_doc" style="display:none">
			<h2 id="results_head">
			<a id="plus__results" href="javascript: section_toggle('results');" class="mod_expand">-</a>
			Search Results (<span id="results_count">0</span>)</h2>
			<div id="results">
			</div>
		</div>
		<div id="recent_doc" style="display:none">
			<h2 id="recent_head">
			<a id="plus__recent" href="javascript: section_toggle('recent');" class="mod_expand">-</a>
			Recent Modules (<span id="recent_count">0</span>)</h2>
			<div id="recent">
				<ul id="ul_recent" class="mod_list" style="display:block">
				</ul>
			</div>
		</div>
		<div id="perl_doc">
			<h2 id="perl_head"><span class="info">i<span>[% perl_path %]</span></span>
			<a id="plus__perl" href="javascript: section_toggle('perl');" class="mod_expand">-</a>
			Perl (<span id="perl_count">0</span>)</h2>
			<div id="perl">
			</div>
		</div>
		<div id="local_doc">
			<h2 id="local_head"><span class="info">i<span>[% local_path %]</span></span>
			<a id="plus__local" href="javascript: section_toggle('local');" class="mod_expand">-</a>
			Local Programs (<span id="local_count">0</span>)</h2>
			<div id="local">
			</div>
		</div>
		<div id="inc_doc">
			<h2 id="inc_head"><span class="info">i<span>[% inc_path %]</span></span>
			<a id="plus__inc" href="javascript: section_toggle('inc');" class="mod_expand">-</a>
			Installed Modules (<span id="inc_count">0</span>)</h2>
			<div id="inc">
			</div>
		</div>
		<a href="http://docperl.sourceforge.net/" target="_blank">DocPerl Home Page</a>
		[% IF ClearCache -%]
		<br />
		<a href="?clearcache=1" target="_top">Clear Cache</a>
		[%- END %]
		<br />
		<a href="?page=list&sidebar=1">Bookmark for Firefox sidebar</a>
	</body>
</html>
